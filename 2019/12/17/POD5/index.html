<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="存储器的结构">
<meta name="keywords" content="计算机组成原理">
<meta property="og:type" content="article">
<meta property="og:title" content="存储器">
<meta property="og:url" content="http://endacsd.github.io/2019/12/17/POD5/index.html">
<meta property="og:site_name" content="endacsd">
<meta property="og:description" content="存储器的结构">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="c:/Users/EndA/AppData/Roaming/Typora/typora-user-images/1576138397087.png">
<meta property="og:updated_time" content="2019-12-18T04:10:49.428Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="存储器">
<meta name="twitter:description" content="存储器的结构">
<meta name="twitter:image" content="c:/Users/EndA/AppData/Roaming/Typora/typora-user-images/1576138397087.png">
  <link rel="canonical" href="http://endacsd.github.io/2019/12/17/POD5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>存储器 | endacsd</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">endacsd</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-playlist">
      
    

    <a href="/playlist/" rel="section"><i class="menu-item-icon fa fa-fw fa-music"></i> <br>歌单</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/endacsd" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://endacsd.github.io/2019/12/17/POD5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="endacsd">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="endacsd">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">存储器

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-12-17 21:18:45" itemprop="dateCreated datePublished" datetime="2019-12-17T21:18:45+08:00">2019-12-17</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-12-18 12:10:49" itemprop="dateModified" datetime="2019-12-18T12:10:49+08:00">2019-12-18</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算机组成原理/" itemprop="url" rel="index"><span itemprop="name">计算机组成原理</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>存储器的结构</p>
<a id="more"></a>
<meta name="referrer" content="no-referrer">





<p><strong>时间局部性</strong>：</p>
<p>如果一个信息项正在被访问，那么在近期它很可能还会被再次访问。</p>
<p>程序循环、堆栈等是产生时间局部性的原因。</p>
<p><strong>空间局部性</strong>：</p>
<p>在最近的将来将用到的信息很可能与现在正在使用的信息在空间地址上是临近的。</p>
<p>程序模块化设计。</p>
<p><strong>顺序局部性</strong>：</p>
<p>在典型程序中，除转移类指令外，大部分指令是顺序进行的。</p>
<p>顺序执行和非顺序执行的比例大致是5:1。</p>
<p>指令的顺序执行、数组的连续存放等是产生顺序局部性的原因</p>
<p>块</p>
<p>如果处理器需要的数据</p>
<p>存放在高层存储器的某个块中</p>
<p><strong>命中</strong>: 在高层存储器中找到目标数据</p>
<p><strong>命中率</strong>:  命中次数/全部访问次数</p>
<p>如果数据不在高层存储器</p>
<p><strong>缺失：</strong>从低层存储器拷贝包含所需数据的块,然后再从高层存储器访问数据</p>
<p><strong>缺失代价</strong>:将相应块从低层存储器替换到高层存储器所需要的时间</p>
<p><strong>缺失率</strong>: 缺失次数/全部访问次数<br>     = 1–命中率</p>
<h4 id="存储器技术"><a href="#存储器技术" class="headerlink" title="存储器技术"></a>存储器技术</h4><p>SRAM 和 DRAM</p>
<p>闪存</p>
<p>磁盘存储器</p>
<p>存储器技术</p>
<p>比较</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>名　称</th>
<th>简称</th>
<th>用　　途</th>
<th>特　点</th>
</tr>
</thead>
<tbody>
<tr>
<td>高速缓冲存储器</td>
<td>Cache</td>
<td>高速存取指令和数据</td>
<td>存取速度快，但存储容量小</td>
</tr>
<tr>
<td>主存储器</td>
<td>主存</td>
<td>存放计算机运行期间的大量程序和数据</td>
<td>存取速度较快，存储容量不大</td>
</tr>
<tr>
<td>外存储器</td>
<td>外存</td>
<td>存放系统程序和大型数据文件及数据库</td>
<td>存储容量大，位成本低</td>
</tr>
</tbody>
</table>
</div>
<p>层次结构</p>
<p><img src="C:\Users\EndA\AppData\Roaming\Typora\typora-user-images\1576138397087.png" alt="1576138397087"></p>
<h5 id="按照存取方式"><a href="#按照存取方式" class="headerlink" title="按照存取方式"></a>按照存取方式</h5><p>​    随机存储器：内存</p>
<p>​    顺序存储器 ：磁带</p>
<p>​    半顺序存储器：磁盘</p>
<h5 id="按读写"><a href="#按读写" class="headerlink" title="按读写"></a>按读写</h5><p>分类表</p>
<h4 id="cache原理"><a href="#cache原理" class="headerlink" title="cache原理"></a>cache原理</h4><p>程序访问的局部性原理</p>
<p>短时间内，CPU对存储器的访问总是局限在某个较小区域内</p>
<p>Cache与主存分成大小相同的块</p>
<p>当CPU读取一个字时，发出此字的内存地址到cache和主存。</p>
<p>控制逻辑判断此字当前是否在 cache中</p>
<p>若在，立即传送给CPU</p>
<p>若不在，则把此字从主存读到CPU，同时，把含有该字的数据块从主存送cache。 </p>
<p>Cache 在存储层次中最靠近CPU</p>
<p>Cache与主存的地址映射</p>
<ul>
<li>直接相联</li>
<li>全相联</li>
<li>组相联</li>
</ul>
<p>由硬件控制</p>
<h5 id="直接映射Cache"><a href="#直接映射Cache" class="headerlink" title="直接映射Cache"></a>直接映射Cache</h5><p>内存中的每个块只能出现在cache 的一个位置</p>
<p>为 主存块地址 mod Cache 中的总块数</p>
<p>（ Cache 的块数为2的幂，所以可以直接取低位地址）</p>
<p>为保证是所请求的字</p>
<p>需要保存高位地址，称之为标记位</p>
<p>有效位 表示某个块是否有效的位</p>
<p>地址划分</p>
<p>Index  V(有效位) Tag(标记位)  Data</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Index(索引)</th>
<th>V(有效位)</th>
<th>Tag(标记位)</th>
<th></th>
<th>数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>n bit</td>
<td>1 bit</td>
<td>m bit</td>
<td></td>
<td>d bit</td>
</tr>
</tbody>
</table>
</div>
<p>$\frac{n<em>m</em>d}{4}=32$</p>
<p>Index Cache块数</p>
<p>V 1 bit 表示是否有效</p>
<p>Tag 标记位 为高位 表示实际上是的位置</p>
<p>Data 数据</p>
<p>假定内存为32位</p>
<p>Cache 为 2^n 块  块大小为2^m 字 (2^(m+2)byte )</p>
<p>Tag 一共有 32 - n - m- 2 </p>
<p>(需要能够表示内存所有的位置)</p>
<p>内存地址会变为</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Tag</th>
<th>Index</th>
<th>Data</th>
</tr>
</thead>
<tbody>
<tr>
<td>标记位</td>
<td>索引</td>
<td>数据</td>
</tr>
</tbody>
</table>
</div>
<p>在Cache 中 索引表现在第几行cache中</p>
<p>特点</p>
<p><strong>地址变换速度快</strong></p>
<p><strong>无需替换算法</strong></p>
<p><strong>不灵活</strong></p>
<p><strong>块冲突概率高</strong></p>
<h6 id="检索过程"><a href="#检索过程" class="headerlink" title="检索过程"></a>检索过程</h6><h5 id="全相联-Cache"><a href="#全相联-Cache" class="headerlink" title="全相联 Cache"></a>全相联 Cache</h5><p>一个给定的块可以被放置在cache的任何位置。</p>
<p>要求能迅速检索cache中的所有项</p>
<p>由于每个项都相关的比较器并行完成（开销昂贵）</p>
<p>内存地址</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Tag</th>
<th>Data</th>
</tr>
</thead>
<tbody>
<tr>
<td>块号</td>
<td>数据</td>
</tr>
</tbody>
</table>
</div>
<p>Tag 与 内存块数有关</p>
<h6 id="检索过程-1"><a href="#检索过程-1" class="headerlink" title="检索过程"></a>检索过程</h6><p>优点：</p>
<p>比较灵活</p>
<p>Cache利用率高</p>
<p>块冲突概率低</p>
<p>使用淘汰算法</p>
<p>缺点：</p>
<p>Cache标记比较太长</p>
<p>比较电路难于设计和实现</p>
<h5 id="n-路组相联Cache"><a href="#n-路组相联Cache" class="headerlink" title="n - 路组相联Cache"></a><em>n</em> - 路组相联Cache</h5><p>每组包含n块</p>
<p>块号决定在哪一组</p>
<p>(块号) mod (cache中的组号)</p>
<p>在一个给定的组中能迅速检索所有块</p>
<p><em>n</em> 个比较器（不很昂贵）</p>
<p>Cache 分组 主存分区       主存每个区的块数与Cache的分组数相同  </p>
<p>组间直接相联</p>
<p>组内全相联</p>
<p>n 路 表示 n 个块一组 </p>
<p>主存中按n个一个块分区</p>
<p>每个区的每一块直接映射到对应的一个组</p>
<p>组内是全相联的</p>
<p>特点</p>
<p>是全相联映像与直接映像的折衷。</p>
<p>较直接映像灵活</p>
<p>较全相联映像标记位短，速度快</p>
<p>地址划分</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>区号</th>
<th>组内块号</th>
<th>Data</th>
</tr>
</thead>
<tbody>
<tr>
<td>标志位</td>
<td>在第几组</td>
<td>数据</td>
</tr>
</tbody>
</table>
</div>
<h6 id="检索过程-2"><a href="#检索过程-2" class="headerlink" title="检索过程"></a>检索过程</h6><p>数据块大小的关系</p>
<p>数据块大能降低缺失率</p>
<p>因为空间局部性</p>
<p>但在一个容量固定的cache中</p>
<p>数据块越大 =&gt; 块数越少</p>
<p>竞争更多 =&gt;增加缺失率</p>
<p>数据块越大 =&gt; 访问刚被替换掉的块的几率越大</p>
<p>大数据块的缺失代价</p>
<p>能掩盖大数据块缺失率低的优点</p>
<p>提前重启和关键字优先能有效地降低缺失代价</p>
<h5 id="Cache的命中率"><a href="#Cache的命中率" class="headerlink" title="Cache的命中率"></a>Cache的命中率</h5><p>Cache始终保存主存最活跃的局部区域的副本，使CPU的访存操作大多数针对Cache，提高整个程序的执行速度。</p>
<p>命中率，越接近1越好。</p>
<p><em>Nc</em>——Cache完成存取的总次数</p>
<p><em>Nm</em>——主存完成存取的总次数</p>
<p><em>h</em>——命中率</p>
<p>$h=\frac{Nc}{Nc+Nm}$</p>
<p>系统平均访问时间越接近cache访问时间越好。</p>
<p>$t_c$——命中时，cache访问时间</p>
<p>$t_m$——未命中时，主存访问时间</p>
<p>$t_a$——系统平均访问时间</p>
<p>$t_a= ht_c+(1-h)t_m$</p>
<h5 id="Cache的缺失处理"><a href="#Cache的缺失处理" class="headerlink" title="Cache的缺失处理"></a>Cache的缺失处理</h5><p>Cache命中时，CPU继续使用该数据，就像什么都有发生过</p>
<p>Cache缺失时</p>
<p>引起CPU流水线阻塞</p>
<p>从下一个存储层次读取数据块</p>
<p>如果指令cache缺失</p>
<p>重新取指，此时该指令在cache中</p>
<p>如果数据cache缺失</p>
<p>完成数据操作，此时数据在cache中</p>
<h5 id="写操作处理"><a href="#写操作处理" class="headerlink" title="写操作处理"></a>写操作处理</h5><p>数据写命中，可以只更新Cache中的块</p>
<p>但这样会导致Cache和主存不一致</p>
<ul>
<li>写直达 ：      将数据同时写入主存  </li>
</ul>
<p>但这样会使写时间更长</p>
<p>解决方法 ： 写缓冲</p>
<p>数据被放入写缓冲等待写存储器操作完成，之后释放写缓冲</p>
<p>CPU立即继续执行其他指令</p>
<p>仅当缓冲区满时产生写阻塞</p>
<ul>
<li>写回法</li>
</ul>
<p>另一种方式：当数据写命中，仅仅更新cache中的块</p>
<p>记录每一块是否被“修改”过 </p>
<p>仅当一个修改过的块被替换时</p>
<p>才写回到较低层的存储结构中（主存）</p>
<p>当缺失替换一个被修改的块时，可先写入写缓冲区，同时从主存读出所需要的数据块，允许先读缓冲区中将替换的块，然后再将数据写回主存。</p>
<p>写缺失时</p>
<p>写直达的策略</p>
<p>缺失时写分配：重新从内存取数据块</p>
<p>相似的写策略：写不分配，不从内存取块</p>
<p>有时程序在读一个块之前通常要写整个块 (e.g., 初始化)</p>
<p>写回法的策略</p>
<p>通常要把这个块从内存取回到cache</p>
<h4 id="Cache-的性能和改进"><a href="#Cache-的性能和改进" class="headerlink" title="Cache 的性能和改进"></a>Cache 的性能和改进</h4><h5 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h5><p>$CPU时间=(CPU的执行时钟周期数+ 存储器阻塞的额时钟周期数)\times 时钟周期$</p>
<p>$存储器阻塞时钟周期数=读操作引起阻塞的时钟周期数+写操作引起阻塞的时钟周期数$</p>
<p>$读操作阻塞的时钟周期数=(读的次数/程序数)\times 读缺失率 \times 读缺失代价$</p>
<p>$写操作阻塞的时钟周期数=[(写的次数/程序数)\times 写缺失率\times 写缺失代价 ]+ 写缓冲阻塞$</p>
<p>平均访问时间 AMAT = 命中时间+ 缺失率 × 缺失代价</p>
<p>对于大部分写直达cache 结构中    读和写的缺失代价是一样的</p>
<p> 忽略写缓冲阻塞下可以写成如下</p>
<script type="math/tex; mode=display">
存储器阻塞时钟周期=\frac{存储器的访问次数}{程序数}\times 缺失率 \times缺失代价
\\
=\frac{指令数}{程序数}\times \frac{缺失数}{指令数}\times 缺失代价</script><p>例子</p>
<p>假设：</p>
<p>I-cache 缺失率 = 2%</p>
<p>D-cache 缺失率 = 4%</p>
<p>缺失代价 = 100 个时钟周期</p>
<p>处理器的 CPI = 2</p>
<p>Load &amp; stores 占全部指令的 36%</p>
<p>每条指令的缺失周期</p>
<p>I-cache: 0.02 × 100 = 2</p>
<p>D-cache: 0.36 × 0.04 × 100 = 1.44</p>
<p>实际 CPI = 2 + 2 + 1.44 = 5.44</p>
<p>理想状态 CPU 快了 5.44/2 =2.72 倍</p>
<h5 id="改进"><a href="#改进" class="headerlink" title="改进"></a>改进</h5><h6 id="通过更灵活地放置块"><a href="#通过更灵活地放置块" class="headerlink" title="通过更灵活地放置块"></a>通过更灵活地放置块</h6><h6 id="替换策略"><a href="#替换策略" class="headerlink" title="替换策略"></a>替换策略</h6><p><strong>LFU</strong>（<strong>最不经常使用</strong> ）：被访问的行计数器增加1，换出值小的行，不能反映近期cache的访问情况，</p>
<p><strong>LRU</strong> <strong>（近期最少使用）</strong> ：被访问的行计数器置0，其他的计数器增加1，换出值大的行，符合cache的工作原理</p>
<p><strong>随机替换：</strong>随机替换策略实际上是从特定的行位置中随机地选取一行换出即可。这种策略在硬件上容易实现，且速度也比前两种策略快。缺点是随意换出的数据很可能马上又要使用，从而降低命中率和cache工作效率。但这个不足随着cache容量增大而减小。</p>
<p><strong>先进先出（FIFO）</strong>：总是把最先进入的Cache字块作为被替换的块。它不需要记录各个字的使用情况，因此开销小，容易实现。但一些常用的程序块容易被替换掉。</p>
<h6 id="使用多级cache"><a href="#使用多级cache" class="headerlink" title="使用多级cache"></a>使用多级cache</h6><p>一级cache隶属于CPU</p>
<p>容量小，但速度快</p>
<p>二级cache可以为一级cache访问缺失提供服务</p>
<p>容量大，速度慢，但仍比主存储器快</p>
<p>主存储器为二级cache的访问缺失提供服务</p>
<p>一些高端系统中包含三级cache</p>
<p>海明码</p>
<h4 id="虚拟存储器"><a href="#虚拟存储器" class="headerlink" title="虚拟存储器"></a>虚拟存储器</h4><ul>
<li>虚拟存储器 一种将主存用辅助存储器高速缓存的技术</li>
</ul>
<ul>
<li>物理地址 主存储器的地址</li>
<li>保护 一组确保共享处理器，主存，I/O 设备的多个进程之间没有故意地，无意地读写其他进程的数据机制，这些保护机制可以将操作系统和用户的进程隔离开来</li>
</ul>
<p>虚拟存储器中，块被称为页 ，缺失访问则被称为缺页</p>
<p>在虚拟存储器中，处理器产生一个虚拟地址，再结合硬件转换形成一个物理地址，然后就可以被用来访问主存了</p>
<ul>
<li>缺页 访问的页不在主存储器中</li>
<li>虚拟地址 虚拟空间中的地址，当需要访问主存时需要通过地址映射转换为物理地址</li>
<li>地址转换 也称为地址映射。 在访问内存时将虚拟地址映射为物理地址的过程</li>
</ul>
<p>虚拟存储器还提供 重定位 允许将程序加载到主存的任何位置</p>
<p>在虚拟地址中， 地址被划分为虚页号 和页偏移</p>
<p>物理页号构成物理地址的高位部分，页偏移固定，构成低位部分，决定页的大小</p>
<p>而虚拟地址可寻址的页数无物理地址是可以不同的，可以比物理地址多，从而容量可以更大</p>
<p>段式管理</p>
<h5 id="页的存放和查找"><a href="#页的存放和查找" class="headerlink" title="页的存放和查找"></a>页的存放和查找</h5><ul>
<li>页表  保存着虚拟地址和物理地址之间转换关系的表，页表保存在主存中，通常使用虚页号来索引，如果这个虚页在当前主存中，页表中的对应项将包含虚页对应的物理页号</li>
</ul>
<h5 id="缺页故障"><a href="#缺页故障" class="headerlink" title="缺页故障"></a>缺页故障</h5><p>如果虚拟页的有效位关闭，就会发生缺页故障</p>
<p>关于写</p>
<p>使用写回法，而非写直达</p>
<p>脏位  判断是否被更改  </p>
<h5 id="TLB"><a href="#TLB" class="headerlink" title="TLB"></a>TLB</h5><p>由于页表放在主存中，所以必然会访问两次主存</p>
<p>先获得物理地址，再获得数据</p>
<p>TLB ： 用于记录最近使用地址的映射信息的高速缓存，从而可以避免每次都要访问页表</p>
<p>TLB 和cache 相似 用于加速，</p>
<p>如果TLB 命中，那么页表一定在主存当中</p>
<h5 id="保护机制"><a href="#保护机制" class="headerlink" title="保护机制"></a>保护机制</h5><h5 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h5><h4 id="存储器层次结构的一般框架"><a href="#存储器层次结构的一般框架" class="headerlink" title="存储器层次结构的一般框架"></a>存储器层次结构的一般框架</h4>
    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/计算机组成原理/" rel="tag"># 计算机组成原理</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/12/17/POD4/" rel="next" title="处理器">
                  <i class="fa fa-chevron-left"></i> 处理器
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#存储器技术"><span class="nav-text">存储器技术</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#按照存取方式"><span class="nav-text">按照存取方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#按读写"><span class="nav-text">按读写</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cache原理"><span class="nav-text">cache原理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#直接映射Cache"><span class="nav-text">直接映射Cache</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#检索过程"><span class="nav-text">检索过程</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#全相联-Cache"><span class="nav-text">全相联 Cache</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#检索过程-1"><span class="nav-text">检索过程</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#n-路组相联Cache"><span class="nav-text">n - 路组相联Cache</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#检索过程-2"><span class="nav-text">检索过程</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Cache的命中率"><span class="nav-text">Cache的命中率</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Cache的缺失处理"><span class="nav-text">Cache的缺失处理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#写操作处理"><span class="nav-text">写操作处理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cache-的性能和改进"><span class="nav-text">Cache 的性能和改进</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#性能"><span class="nav-text">性能</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#改进"><span class="nav-text">改进</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#通过更灵活地放置块"><span class="nav-text">通过更灵活地放置块</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#替换策略"><span class="nav-text">替换策略</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#使用多级cache"><span class="nav-text">使用多级cache</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#虚拟存储器"><span class="nav-text">虚拟存储器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#页的存放和查找"><span class="nav-text">页的存放和查找</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#缺页故障"><span class="nav-text">缺页故障</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#TLB"><span class="nav-text">TLB</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#保护机制"><span class="nav-text">保护机制</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#小结"><span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#存储器层次结构的一般框架"><span class="nav-text">存储器层次结构的一般框架</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.png"
      alt="endacsd">
  <p class="site-author-name" itemprop="name">endacsd</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">endacsd</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.ui.min.js"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var id = element.id || '';
    var src = element.src || '';
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (id !=='') {
      script.id = element.id;
    }
    if (src !== '') {
      script.src = src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  








  <script src="/js/local-search.js?v=7.4.0"></script>













    <div id="pjax">

  

  
    
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    
  

  

  

    </div>
</body>
</html>
